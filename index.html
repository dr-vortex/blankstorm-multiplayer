<!DOCTYPE html>
<html>
	<head>
	    <title>Annihilation Socket Test</title>
		<link rel=stylesheet href=https://a.drvortex.dev/libraries/styles.css>
	</head>
	<body>
		<button id=connect>Connect</button>
		<button id=ping>Ping</button>
		<br>
		<input id=auth placeholder='Password'>
		<input id=data placeholder='Packet Content'>
		<button id=packet>Send Packet</button>
		<br>
		<ul id=log style=font-family:monospace; lsn nobg></ul>
        <script src=/libraries/jquery.js></script>
		<script src=/libraries/socket.max.js></script>
		<script>
		    Object.prototype.toString = function(){return JSON.stringify(this)}
		    const log = data => $('<li></li>').text(data).appendTo('#log');
		    let socket;
		    $('#connect').click(e => {
		        log('Attempting to connect')
		        socket = io('mp.annihilation.drvortex.dev', { reconnection: false });
		        socket.on('connect' , s => {
		            log('Connected to server as ' + socket.id);
		        });
		        socket.on('connect_error', err => {
		            log('Connection error: ' + err);
		        });
		        socket.on('connect_failed', err => {
		            log('Connection failed: ' + err);
		        });
		        socket.on('packet', packet => {
		           log('Response packet recieved: ' + packet);
		        });
		    });
		    $('#ping').click(e => {
		       if(socket.connected){
		           log('Pinged server');
		           socket.emit('ping');
		       }else{
		           log('Can\'t send ping: socket not connected');
		       }
		    });
		    $('#packet').click(e => {
		        if(socket.connected){
		            log('Sent packet');
		            socket.emit('packet',{auth:$('#auth').val(),content:$('#data').val()});
		        }else{
		            log('Can\'t send packet: socket not connected');
		        }
		    })
		</script>
	</body>
</html>